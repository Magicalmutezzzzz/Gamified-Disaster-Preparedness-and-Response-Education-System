<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Module 1 — Assignment 2: Fire Escape (Video)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
    :root{
      --bg:#07102a;--card:#0f1724;--muted:#cfe5ff;--accent:#ff6b35;--success:#22c55e;--danger:#ef4444;--glass: rgba(255,255,255,0.03);--maxw:1100px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,var(--bg), #021024);color:#e6f0ff}
    .wrap{max-width:var(--maxw);margin:28px auto;padding:20px;display:grid;grid-template-columns:1fr 380px;gap:20px}
    .left,.right{background:var(--card);border-radius:12px;padding:18px;border:1px solid rgba(255,255,255,0.03)}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
    h1{margin:0;font-size:20px;color:var(--accent)}.sub{color:var(--muted);opacity:0.9;font-size:13px}
    .video-wrap{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:12px;border-radius:10px;box-shadow:0 8px 24px rgba(2,6,23,0.6)}
    .video-embed{width:100%;height:0;padding-bottom:56.25%;position:relative;border-radius:8px;overflow:hidden;border:1px solid rgba(255,255,255,0.03)}
    .video-embed iframe{position:absolute;inset:0;width:100%;height:100%;border:0;}
    .meta{margin-top:12px;background:var(--glass);padding:12px;border-radius:8px}
    .meta h4{margin:0 0 8px 0;font-size:15px}.meta p{margin:0;font-size:13px;color:#d6e9ff;line-height:1.4}
    form.quiz{margin-top:18px;display:flex;flex-direction:column;gap:12px}
    .question{background:rgba(255,255,255,0.02);padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.02)}
    .question h4{margin:0 0 8px 0;font-size:14px}
    .options{display:grid;gap:8px}
    .opt{display:flex;align-items:center;gap:10px;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.02);cursor:pointer;background:transparent}
    .opt input{transform:scale(1.05)}.opt:hover{background:rgba(255,255,255,0.02)}
    .actions{display:flex;gap:10px;align-items:center;margin-top:10px}
    .btn{background:var(--accent);color:#fff;border:none;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}
    .note{font-size:13px;color:var(--muted)}
    .card-title{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .progress-ring{width:200px;height:200px;margin:10px auto}
    .stats{display:flex;flex-direction:column;gap:10px;margin-top:10px}
    .stat{display:flex;justify-content:space-between;align-items:center;padding:8px;background:rgba(255,255,255,0.02);border-radius:8px}
    .correct{border-left:6px solid var(--success);background:rgba(34,197,94,0.03)}
    .incorrect{border-left:6px solid var(--danger);background:rgba(239,68,68,0.03)}
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(rgba(2,6,23,0.5),rgba(2,6,23,0.6))}
    .modal-inner{background:var(--card);padding:20px;border-radius:12px;width:380px;border:1px solid rgba(255,255,255,0.04);text-align:center}
    .modal-inner h3{margin:0 0 8px 0;color:var(--accent)}.modal-inner p{margin:0 0 12px 0;color:var(--muted)}
    .close-btn{background:#fff;color:#000;border-radius:8px;padding:8px 12px;border:none;cursor:pointer}
    @media (max-width:980px){.wrap{grid-template-columns:1fr}.right{order:2}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="left">
      <header>
        <div>
          <h1>Module 1 • Fire Escape</h1>
          <div class="sub">Assignment 2 — Fire Drill & Safe Evacuation</div>
        </div>
        <div style="text-align:right">
          <div class="sub">Est. time: <strong>7–9 min</strong></div>
          <a class="btn ghost" href="module1.html" style="margin-top:8px;display:inline-block">Back to Module</a>
        </div>
      </header>

      <div class="video-wrap">
        <div class="video-embed">
          <!-- Updated video embed -->
          <iframe 
            src="https://www.youtube.com/embed/GgiRj9QVPo4" 
            title="Fire Drill and Evacuation Training" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
            allowfullscreen>
          </iframe>
        </div>

        <div class="meta" role="region" aria-labelledby="descTitle">
          <h4 id="descTitle">Video Description</h4>
          <p>
            This training video explains how fire drills are conducted, why evacuation procedures must be practiced regularly, 
            and the roles of fire wardens in guiding people to safe assembly points. It emphasizes staying calm, not using elevators, 
            following exit signs, and ensuring accountability during emergency evacuations.
          </p>

          <h4 style="margin-top:10px">Learning Objectives</h4>
          <ul style="margin:6px 0 0 18px;color:#d6e9ff;line-height:1.4">
            <li>Understand the importance of regular fire drills.</li>
            <li>Learn proper evacuation routes and safe behaviors.</li>
            <li>Recognize the role of fire wardens and assembly points.</li>
          </ul>
        </div>
      </div>

      <form class="quiz" id="quizForm" aria-label="Quiz for Assignment 2"></form>

      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px">
        <div class="note">Each question: <strong>1 mark</strong>. Total: 10 marks.</div>
        <div class="actions">
          <button class="btn" id="submitBtn" type="button">Submit Answers</button>
          <button class="btn ghost" id="clearBtn" type="button">Reset Answers</button>
        </div>
      </div>
    </div>

    <aside class="right" aria-label="Progress & Stats">
      <div class="card-title">
        <div><strong style="color:var(--muted)">Progress</strong><div style="font-size:12px;color:#bcd8ff">Module 1 — Fire Escape</div></div>
        <div style="font-size:12px;color:var(--muted)">Assignment 2</div>
      </div>

      <div style="text-align:center">
        <svg viewBox="0 0 36 36" class="progress-ring" id="progressSvg" width="200" height="200">
          <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#374151" stroke-width="3.5"></path>
          <path id="progressArc" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#22c55e" stroke-width="3.5" stroke-dasharray="0 100"></path>
          <text x="18" y="20.5" font-size="6" text-anchor="middle" fill="#fff" id="progressText">0%</text>
        </svg>
      </div>

      <div class="stats">
        <div class="stat"><div style="font-size:14px">Completed Assignments</div><div id="completedCount">0 / 15</div></div>
        <div class="stat"><div style="font-size:14px">Your score (this assignment)</div><div id="lastScore">—</div></div>
        <div class="stat"><div style="font-size:14px">Module Avg. (so far)</div><div id="avgScore">—</div></div>
      </div>

      <div style="margin-top:12px;font-size:13px;color:var(--muted)">
        Tip: Always stay calm, use stairs not elevators, and head directly to the assembly point during fire drills.
      </div>
    </aside>
  </div>

  <div class="modal" id="resultModal" role="dialog" aria-modal="true">
    <div class="modal-inner">
      <h3>Great job!</h3>
      <p id="modalMsg">You scored X / 10</p>
      <div style="margin-top:12px;display:flex;gap:8px;justify-content:center">
        <button class="close-btn" id="modalOk">OK</button>
      </div>
    </div>
  </div>

  <script>
    const QUESTIONS = [
      { q: "What is the main purpose of a fire drill?", options:["To waste time","To practice safe evacuation procedures","To test alarms only","To check building design"], a:1 },
      { q: "During an evacuation, which is the safest choice?", options:["Use the elevator","Run and shout","Use stairways and follow exit signs","Wait at your desk"], a:2 },
      { q: "Who guides people during fire drills?", options:["Security guards only","Fire wardens or designated leaders","Random employees","Nobody"], a:1 },
      { q: "What should you do if smoke fills a corridor?", options:["Walk upright normally","Crawl low under the smoke","Hold your breath and run","Go back inside"], a:1 },
      { q: "What is the purpose of an assembly point?", options:["To gather belongings","To account for all people safely","To rest after evacuation","To call friends"], a:1 },
      { q: "Why should elevators not be used in fire evacuation?", options:["They are too slow","They may fail or trap people","They are crowded","They create smoke"], a:1 },
      { q: "What is the role of a fire warden?", options:["To carry fire hoses","To supervise evacuation and guide people","To ignore alarms","To test staircases"], a:1 },
      { q: "What is the first thing to do when the alarm sounds?", options:["Look for your bag","Evacuate immediately via the nearest safe exit","Wait for confirmation","Continue working"], a:1 },
      { q: "Why is staying calm important during fire drills?", options:["To save energy","To avoid panic and ensure orderly evacuation","To impress others","It is not important"], a:1 },
      { q: "After reaching the assembly point, you should:", options:["Go back to your room","Wait until the all-clear is given","Leave immediately","Smoke outside"], a:1 }
    ];

    const STORAGE_KEY = 'lifesafe_module1_progress';
    const ASSIGNMENT_NUMBER = 2;
    const TOTAL_ASSIGNMENTS = 15;

    const quizForm = document.getElementById('quizForm');
    const submitBtn = document.getElementById('submitBtn');
    const clearBtn = document.getElementById('clearBtn');
    const modal = document.getElementById('resultModal');
    const modalMsg = document.getElementById('modalMsg');
    const modalOk = document.getElementById('modalOk');
    const completedCountEl = document.getElementById('completedCount');
    const lastScoreEl = document.getElementById('lastScore');
    const avgScoreEl = document.getElementById('avgScore');
    const progressText = document.getElementById('progressText');
    const progressArc = document.getElementById('progressArc');

    function renderQuestions(){
      QUESTIONS.forEach((item, idx) => {
        const qDiv = document.createElement('div');
        qDiv.className = 'question';
        qDiv.innerHTML = `<h4>Q${idx+1}. ${item.q}</h4><div class="options"></div>`;
        const opts = qDiv.querySelector('.options');
        item.options.forEach((op, oi) => {
          const id = `q${idx}_opt${oi}`;
          const label = document.createElement('label');
          label.className = 'opt';
          label.innerHTML = `<input type="radio" name="q${idx}" id="${id}" value="${oi}" /> <span style="font-size:14px">${op}</span>`;
          opts.appendChild(label);
        });
        quizForm.appendChild(qDiv);
      });
    }

    function loadProgress(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)) || {completed:[], scores:{}} }catch(e){return {completed:[], scores:{}}} }
    function saveProgress(p){ localStorage.setItem(STORAGE_KEY, JSON.stringify(p)); }

    function updateRightPanel(){
      const p = loadProgress();
      const done = p.completed.length;
      completedCountEl.textContent = `${done} / ${TOTAL_ASSIGNMENTS}`;
      const lastScore = p.scores && p.scores[ASSIGNMENT_NUMBER] !== undefined ? p.scores[ASSIGNMENT_NUMBER] : '—';
      lastScoreEl.textContent = lastScore === '—' ? '—' : `${lastScore} / 10`;
      const scoresArr = Object.values(p.scores||{}).filter(v=>typeof v==='number');
      const avg = scoresArr.length ? (scoresArr.reduce((a,b)=>a+b,0)/scoresArr.length).toFixed(1) : '—';
      avgScoreEl.textContent = avg === '—' ? '—' : `${avg} / 10`;
      const pct = Math.round((done / TOTAL_ASSIGNMENTS) * 100);
      progressText.textContent = pct + '%';
      const circumference = 100;
      const dash = (pct/100)*circumference;
      progressArc.setAttribute('stroke-dasharray', `${dash} ${circumference - dash}`);
    }

    function validateAnswers(){
      for(let i=0;i<QUESTIONS.length;i++){
        const els = document.getElementsByName('q'+i);
        let answered=false;
        for(const e of els){ if(e.checked){ answered=true; break; } }
        if(!answered) return false;
      }
      return true;
    }

    function gradeAndSave(){
      let score=0;
      QUESTIONS.forEach((item, idx)=>{
        const ans = document.querySelector(`input[name="q${idx}"]:checked`);
        const chosen = ans ? parseInt(ans.value,10) : null;
        const qDiv = ans ? ans.closest('.question') : document.getElementsByClassName('question')[idx];
        if(chosen === item.a){
          score +=1;
          if(qDiv){ qDiv.classList.remove('incorrect'); qDiv.classList.add('correct'); }
        } else {
          if(qDiv){ qDiv.classList.remove('correct'); qDiv.classList.add('incorrect'); }
        }
      });

      const state = loadProgress();
      if(!Array.isArray(state.completed)) state.completed=[];
      if(!state.scores) state.scores={};
      if(!state.completed.includes(ASSIGNMENT_NUMBER)) state.completed.push(ASSIGNMENT_NUMBER);
      state.scores[ASSIGNMENT_NUMBER] = score;
      saveProgress(state);

      modalMsg.textContent = `You scored ${score} / ${QUESTIONS.length}`;
      modal.style.display = 'flex';
      submitBtn.disabled = true;
      submitBtn.textContent = 'Submitted ✓';
      updateRightPanel();
    }

    submitBtn.addEventListener('click', function(){
      if(!validateAnswers()){ alert('Please answer all questions before submitting.'); return; }
      gradeAndSave();
    });
    clearBtn.addEventListener('click', function(){
      document.querySelectorAll('input[type="radio"]').forEach(r=>r.checked=false);
      document.querySelectorAll('.question').forEach(q=>{q.classList.remove('correct','incorrect')});
      submitBtn.disabled = false; submitBtn.textContent = 'Submit Answers';
    });
    modalOk.addEventListener('click', function(){ modal.style.display = 'none'; window.location.href='module1.html'; });

    renderQuestions(); updateRightPanel();
  </script>
</body>
</html>